<!DOCTYPE html>
<html>
<body style="margin:0;display:flex;align-items:center;justify-content:center;background:#000">
<img id="img">

<script>
function mulberry32(a) {
  return function() {
    a |= 0; a = a + 0x6D2B79F5 | 0;
    let t = Math.imul(a ^ a >>> 15, 1 | a);
    t ^= t + Math.imul(t ^ t >>> 7, 61 | t);
    return ((t ^ t >>> 14) >>> 0) / 4294967296;
  }
}

const parts = location.pathname.split("/").filter(Boolean);

// If repo name exists, remove it
if (parts.length && parts[0].includes(".github.io")) parts.shift();

let w = 500;
let h = 500;
let seed = 1;
let format = "png";

if (parts.length >= 2) {
  w = parseInt(parts[parts.length - 4]) || 500;
  h = parseInt(parts[parts.length - 3]) || 500;
  seed = parseInt(parts[parts.length - 2]) || seed;
  format = parts[parts.length - 1] || format;
}

const rand = mulberry32(seed);

const canvas = document.createElement("canvas");
canvas.width = w;
canvas.height = h;
const ctx = canvas.getContext("2d");

const imgData = ctx.createImageData(w, h);
for (let i = 0; i < imgData.data.length; i += 4) {
  imgData.data[i]     = rand() * 255;
  imgData.data[i + 1] = rand() * 255;
  imgData.data[i + 2] = rand() * 255;
  imgData.data[i + 3] = 255;
}
ctx.putImageData(imgData, 0, 0);

const img = document.getElementById("img");

if (format === "gif") {
  setInterval(() => {
    for (let i = 0; i < imgData.data.length; i += 4) {
      imgData.data[i]     = rand() * 255;
      imgData.data[i + 1] = rand() * 255;
      imgData.data[i + 2] = rand() * 255;
    }
    ctx.putImageData(imgData, 0, 0);
    img.src = canvas.toDataURL("image/png");
  }, 120);
} else {
  img.src = canvas.toDataURL("image/" + format);
}
</script>
</body>
</html>
